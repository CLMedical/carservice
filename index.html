<html lang="en">
<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href='https://fonts.googleapis.com/css?family=Bai Jamjuree' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <script src="https://code.jquery.com/jquery-3.1.0.js"></script>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous" />
    <title>ศูนย์บริการยาง</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous"></script>

    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    
    <!-- SweetAlert2 เวอร์ชัน 11 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        window.onload = function() {
            Swal.fire({
                title: 'หยุดปีใหม่ 30 ธ.ค. ถึง 2 ม.ค.',
                text: 'โปรดทราบว่าในช่วงเวลาดังกล่าวไม่มีการให้บริการจองคิว',
                icon: 'info',
                confirmButtonText: 'เข้าใช้งาน',
            }).then((result) => {
                if (result.isConfirmed) {
                    // สามารถดำเนินการต่อไปในหน้าจองคิวได้
                }
            });
        }
    </script>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Kanit" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
</head>
<body oncontextmenu="return false">
    <div class="mt-4 text-center">
        <div clas="justify-content-center align-items-center">
            <!-- -------- ตัวเลขนับถอยหลัง ------ -->
            <!-- <div id="timer"></div> -->
            <h1 class="text-center" style="color: darkgreen;">ศูนย์บริการยาง</h1>
            <!-- -------- ข้อความแจ้งเตือนด้านล่างของตัวนับ ------ -->
            <!--<div class="mt-4 text-center text-light" id="msgStatus"></div>-->
        </div>
    </div>
    <!-- <section id="cover" style="display:none;"> -->
        <div id="loginPage" style="display:block;">
            <div id="login-form" class="container-sm fade-in-page mt-4 card-form "
                style="max-width: 25rem; display:block;">
                <div class="container py-4">
                    <div class="form-group mt-3">
                        <form id="loginForm" class="was-validated" autocomplete="off" name="google-sheet"
                            onsubmit="return validateForm()">
                            <div class="container">
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-12 center">
                                    <div class="form-row">
                                        <div class="form-group col-md-12">
                                            <center> <img id="picURL" class="avatar" alt="profile" width="50"
                                                    height="50"><br></center>
                                            <div class="mb-3 mt-3">
                                                <label for="uname" class="form-label">ข้อมูลลงทะเบียน</label>
                                                <input type="text" class="form-control" name="UName" id="uname"
                                                    readonly>
                                                <input id="uid" class="form-control" name="Uid" style="display:none;">
                                               <img id="upic" name="Upic" width="25%">
                                            </div>
                                        </div>
                                        

                                        <div class="form-group col-md-12">
                                            <label for="number1">เลขทะเบียนรถ</label>
                                            <input type="text" class="form-control" placeholder="เลขทะเบียนรถ" id="number1"
                                                name="number1" required>
                                            <!--<div class="valid-feedback">ผ่าน</div>-->
                                            <!--<div class="invalid-feedback">ผ่าน</div>-->
                                        </div>
                                        <div class="form-group col-md-12">
            <label for="number2">จังหวัด</label>
            <select class="form-control" id="number2" name="number2" required>
                <option value="" disabled selected>เลือกจังหวัด</option>
                <option value="กรุงเทพมหานคร">กรุงเทพมหานคร</option>
                <option value="กระบี่">กระบี่</option>
                <option value="กาญจนบุรี">กาญจนบุรี</option>
                <option value="กาฬสินธุ์">กาฬสินธุ์</option>
                <option value="กำแพงเพชร">กำแพงเพชร</option>
                <option value="ขอนแก่น">ขอนแก่น</option>
                <option value="จันทบุรี">จันทบุรี</option>
                <option value="ฉะเชิงเทรา">ฉะเชิงเทรา</option>
                <option value="ชลบุรี">ชลบุรี</option>
                <option value="ชัยนาท">ชัยนาท</option>
                <option value="ชัยภูมิ">ชัยภูมิ</option>
                <option value="ชุมพร">ชุมพร</option>
                <option value="เชียงราย">เชียงราย</option>
                <option value="เชียงใหม่">เชียงใหม่</option>
                <option value="ตรัง">ตรัง</option>
                <option value="ตราด">ตราด</option>
                <option value="ตาก">ตาก</option>
                <option value="นครนายก">นครนายก</option>
                <option value="นครปฐม">นครปฐม</option>
                <option value="นครพนม">นครพนม</option>
                <option value="นครราชสีมา">นครราชสีมา</option>
                <option value="นครศรีธรรมราช">นครศรีธรรมราช</option>
                <option value="นครสวรรค์">นครสวรรค์</option>
                <option value="นนทบุรี">นนทบุรี</option>
                <option value="นราธิวาส">นราธิวาส</option>
                <option value="น่าน">น่าน</option>
                <option value="บึงกาฬ">บึงกาฬ</option>
                <option value="บุรีรัมย์">บุรีรัมย์</option>
                <option value="ปทุมธานี">ปทุมธานี</option>
                <option value="ประจวบคีรีขันธ์">ประจวบคีรีขันธ์</option>
                <option value="ปราจีนบุรี">ปราจีนบุรี</option>
                <option value="ปัตตานี">ปัตตานี</option>
                <option value="พระนครศรีอยุธยา">พระนครศรีอยุธยา</option>
                <option value="พังงา">พังงา</option>
                <option value="พัทลุง">พัทลุง</option>
                <option value="พิจิตร">พิจิตร</option>
                <option value="พิษณุโลก">พิษณุโลก</option>
                <option value="เพชรบุรี">เพชรบุรี</option>
                <option value="เพชรบูรณ์">เพชรบูรณ์</option>
                <option value="แพร่">แพร่</option>
                <option value="พะเยา">พะเยา</option>
                <option value="ภูเก็ต">ภูเก็ต</option>
                <option value="มหาสารคาม">มหาสารคาม</option>
                <option value="มุกดาหาร">มุกดาหาร</option>
                <option value="แม่ฮ่องสอน">แม่ฮ่องสอน</option>
                <option value="ยโสธร">ยโสธร</option>
                <option value="ยะลา">ยะลา</option>
                <option value="ร้อยเอ็ด">ร้อยเอ็ด</option>
                <option value="ระนอง">ระนอง</option>
                <option value="ระยอง">ระยอง</option>
                <option value="ราชบุรี">ราชบุรี</option>
                <option value="ลพบุรี">ลพบุรี</option>
                <option value="ลำปาง">ลำปาง</option>
                <option value="ลำพูน">ลำพูน</option>
                <option value="เลย">เลย</option>
                <option value="ศรีสะเกษ">ศรีสะเกษ</option>
                <option value="สกลนคร">สกลนคร</option>
                <option value="สงขลา">สงขลา</option>
                <option value="สตูล">สตูล</option>
                <option value="สมุทรปราการ">สมุทรปราการ</option>
                <option value="สมุทรสงคราม">สมุทรสงคราม</option>
                <option value="สมุทรสาคร">สมุทรสาคร</option>
                <option value="สระแก้ว">สระแก้ว</option>
                <option value="สระบุรี">สระบุรี</option>
                <option value="สิงห์บุรี">สิงห์บุรี</option>
                <option value="สุโขทัย">สุโขทัย</option>
                <option value="สุพรรณบุรี">สุพรรณบุรี</option>
                <option value="สุราษฎร์ธานี">สุราษฎร์ธานี</option>
                <option value="สุรินทร์">สุรินทร์</option>
                <option value="หนองคาย">หนองคาย</option>
                <option value="หนองบัวลำภู">หนองบัวลำภู</option>
                <option value="อ่างทอง">อ่างทอง</option>
                <option value="อุดรธานี">อุดรธานี</option>
                <option value="อุทัยธานี">อุทัยธานี</option>
                <option value="อุตรดิตถ์">อุตรดิตถ์</option>
                <option value="อุบลราชธานี">อุบลราชธานี</option>
                <option value="อำนาจเจริญ">อำนาจเจริญ</option>
            </select>
            <!--<div class="valid-feedback">ผ่าน</div>-->
            <!--<div class="invalid-feedback">กรุณาป้อนข้อมูลให้ครบ</div>-->
        </div>
                                        <div class="form-group col-md-12">
                                            <label for="number1">เบอร์โทรติดต่อ</label>
                                            <input type="tel" class="form-control" pattern="[0-9]{10}"
                                                oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                                                placeholder="ระบุเบอร์โทรศัพท์" id="tel" name="tel" maxlength="10"
                                                minlength="10" required>
                                            <!--<div class="valid-feedback">ผ่าน</div>-->
                                            <!--<div class="invalid-feedback">กรุณาป้อนเบอร์โทรให้ครบ10หลัก</div> -->
                                        </div>
                                        <div class="form-group col-md-12">
                                            <label for="number3">วันที่เข้ารับบริการ</label>
                                            <input type="date" class="form-control" placeholder="กรุณาเลือกวันที่" id="number3"
                                                name="number3" required>
                                            <!--<div class="valid-feedback">ผ่าน</div>-->
                                            <!--<div class="invalid-feedback">กรุณาป้อนข้อมูลให้ครบ</div>-->
                                        </div>
                                        <!--<div class="form-group col-md-12">
                                            <label for="number3">email</label>
                                            <input type="email" class="form-control" placeholder="เลขที่3" id="number3"
                                                name="number3" required>
                                            <div class="valid-feedback">ผ่าน</div>
                                            <div class="invalid-feedback">กรุณาป้อนข้อมูลให้ครบ</div>
                                        </div>-->
                                        
                                        <!--<div class="form-group col-md-12">
                                            <label for="number5">นัดเพื่อ</label>
                                            <input type="text" class="form-control" placeholder="นัดเพื่อ(หากไม่ทราบให้เว้นว่าง)" id="number4"
                                                name="number4" >
                                            <!--<div class="valid-feedback">ผ่าน</div>-->
                                            <!--<div class="invalid-feedback">กรุณาป้อนข้อมูลให้ครบ</div>-->
                                        </div>
                                    </div>
                                    <div class="row"> </div>
                                    <div class="col"> </div>
                                    <div class="form-check mb-3">
                                        <script
                                            src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
                                        <input type="checkbox" class="form-check-input" name='visto' id='visto' value=''
                                            required>
                                        <label class="form-check-label"
                                            for="validationFormCheck1">ข้อมูลถูกต้อง</label>
                                        <div class="invalid-feedback">กรุณาทำเครื่องหมายในช่องสี่เหลี่ยม
                                        </div>
                                    </div>
                                    <button type="submit" name="submit" id="submit"
                                        class="btn btn-primary bd-indigo-500 btn-block text-white" disabled><i
                                            class="fas fa-paper-plane"></i>กดส่งข้อมูล</button>
                                </div>
                            </div>
                    </div>
                </div>
            </div>

            </form>

        </div>
        </div>
        </div>







        <script type="text/javascript">
          

            window.onload = function () {
                initializeLiff("1657056533-GevmM1NL");
            };

            function initializeLiff(myLiffId) {
                liff
                    .init({
                        liffId: myLiffId
                    })
                    .then(() => {
                        getid();
                    })
                    .then(() => {
                        testclick();
                    })
                    .catch(err => { });
            }

            function getid() {
                liff.getProfile().then(function (profile) {
                    const uid = profile.userId;
                    const uname = profile.displayName;
                    const upic = profile.pictureUrl;
                    document.getElementById("picURL").src = upic;  // แสดงรูป Profile ที่ดึงมา
                    document.getElementsByName("Uid")[0].value = uid;
                    document.getElementsByName("UName")[0].value = uname;
                    document.getElementsByName("Upic")[0].value = upic;
                });
            }

            

       
            const scriptURL = 'https://script.google.com/macros/s/AKfycbyI5GgPS4HadUnSxLgdjxtpWrJMXN5X849iteqUfYwVyvso6PlhsnjK882RbMOMXho6ow/exec'
            const form = document.forms['google-sheet']

           form.addEventListener('submit', e => {
    e.preventDefault();
    
    // แสดง SweetAlert ขณะกำลังส่งข้อมูล
    Swal.fire({
        title: 'กำลังส่งข้อมูล...',
        text: 'กรุณารอสักครู่',
        allowOutsideClick: false,
        didOpen: () => {
            Swal.showLoading();
        }
    });

    fetch(scriptURL, { method: 'POST', body: new FormData(form) })
        .then(response => {
            if (response.ok) {
                // ปิด SweetAlert ที่กำลังแสดงอยู่
                Swal.close();

                // แสดง SweetAlert แจ้งเตือนเมื่อสำเร็จ
                Swal.fire({
                    icon: 'success',
                    title: 'ลงทะเบียนสำเร็จ!',
                    text: 'ข้อมูลของคุณได้ถูกบันทึกแล้ว',
                    confirmButtonText: 'ตกลง'
                }).then(() => {
                    // รีเซ็ตฟอร์ม
                    form.reset();
                });
            } else {
                throw new Error('Network response was not ok.');
            }
        })
        .catch(error => {
            console.error('Error:', error);

            // ปิด SweetAlert ที่กำลังแสดงอยู่
            Swal.close();

            // แสดง SweetAlert แจ้งเตือนเมื่อเกิดข้อผิดพลาด
            Swal.fire({
                icon: 'error',
                title: 'เกิดข้อผิดพลาด!',
                text: 'ไม่สามารถบันทึกข้อมูลได้ กรุณาลองใหม่อีกครั้ง',
                confirmButtonText: 'ตกลง'
            });
        });
});

        </script>

        <script>
            $(document).ready(function () {
                $('#submit').prop('disabled', true);
                $('#visto').click(function () {
                    if ($(this).is(':checked')) {
                        $('#submit').prop('disabled', false);
                    }
                    else {
                        $('#submit').prop('disabled', true);
                    }
                });
            });
        </script>
        <script>
            function closeMe() {
                setTimeout(window.close, 0);
                liff.closeWindow();
            }




            function validateForm() {
                  var telField = document.getElementById("tel");
                  var number1Field = document.getElementById("number1");
                  var number2Field = document.getElementById("number2");
                  var number3Field = document.getElementById("number3");
                  var number4Field = document.getElementById("number4");
                  var number5Field = document.getElementById("number5");
                  var vistoCheckbox = document.getElementById("visto");
                  // Add your validation logic here
                  var isValid = true;

                  if (telField.value.length !== 10 || isNaN(telField.value)) {
                      isValid = false;
                    $('#submit').prop('disabled', true);
                  }

                  // Add more validation checks for other fields...

                  // Enable or disable the submit button based on validation result
                  var submitButton = document.getElementById("submit");
                  submitButton.disabled = !isValid;
                  return isValid;
                 $('#submit').prop('disabled', true);
              }
            }

            $(document).ready(function () {
                $('#submit').prop('disabled', true);

                $('#visto').click(function () {
                    if ($(this).is(':checked')) {
                        $('#submit').prop('disabled', false);
                    } else {
                        $('#submit').prop('disabled', true);
                    }
                });
            });
        </script>

        <script src="script.js" theme="blue" defer></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
        integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
        integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
        crossorigin="anonymous"></script>
</body>

</html>
